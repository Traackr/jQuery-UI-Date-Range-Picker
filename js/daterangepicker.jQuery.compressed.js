(function(e){e.fn.daterangepicker=function(t){function h(t){if(!t.getDate()){return""}var n=t.getDate();var i=t.getMonth();var s=t.getFullYear();i++;var o=r.dateFormat;return e.datepicker.formatDate(o,t)}function p(){if(l.data("state")=="closed"){m();l.fadeIn(300).data("state","open");r.onOpen()}}function d(){if(l.data("state")=="open"){l.fadeOut(300).data("state","closed");r.onClose()}}function v(){if(l.data("state")=="open"){d()}else{p()}}function m(){var t=S||n;var r=t.offset(),i="left",s=r.left,o=e(window).width()-s-t.outerWidth();if(s>o){i="right",s=o}l.parent().css(i,s).css("top",r.top+t.outerHeight())}function g(e,t,n,i){if(e.is(".ui-daterangepicker-specificDate")){i.hide();n.show();t.find(".title-start").text(r.presets.specificDate);t.find(".range-start").restoreDateFromData().css("opacity",1).show(400);t.find(".range-end").restoreDateFromData().css("opacity",0).hide(400);setTimeout(function(){i.fadeIn()},400)}else if(e.is(".ui-daterangepicker-allDatesBefore")){i.hide();n.show();t.find(".title-end").text(r.presets.allDatesBefore);t.find(".range-start").saveDateToData().datepicker("setDate",r.earliestDate).css("opacity",0).hide(400);t.find(".range-end").restoreDateFromData().css("opacity",1).show(400);setTimeout(function(){i.fadeIn()},400)}else if(e.is(".ui-daterangepicker-allDatesAfter")){i.hide();n.show();t.find(".title-start").text(r.presets.allDatesAfter);t.find(".range-start").restoreDateFromData().css("opacity",1).show(400);t.find(".range-end").saveDateToData().datepicker("setDate",r.latestDate).css("opacity",0).hide(400);setTimeout(function(){i.fadeIn()},400)}else if(e.is(".ui-daterangepicker-dateRange")){i.hide();n.show();t.find(".title-start").text(r.rangeStartTitle);t.find(".title-end").text(r.rangeEndTitle);t.find(".range-start").restoreDateFromData().css("opacity",1).show(400);t.find(".range-end").restoreDateFromData().css("opacity",1).show(400);setTimeout(function(){i.fadeIn()},400)}else{i.hide();t.find(".range-start, .range-end").css("opacity",0).hide(400,function(){n.hide()});var s=typeof e.data("dateStart")=="string"?Date.parse(e.data("dateStart")):e.data("dateStart")();var o=typeof e.data("dateEnd")=="string"?Date.parse(e.data("dateEnd")):e.data("dateEnd")();t.find(".range-start").datepicker("setDate",s).find(".ui-datepicker-current-day").trigger("click");t.find(".range-end").datepicker("setDate",o).find(".ui-datepicker-current-day").trigger("click")}return false}var n=e(this);var r=e.extend({presetRanges:[{text:"Today",dateStart:"today",dateEnd:"today"},{text:"Last 7 days",dateStart:"today-7days",dateEnd:"today"},{text:"Month to date",dateStart:function(){return Date.parse("today").moveToFirstDayOfMonth()},dateEnd:"today"},{text:"Year to date",dateStart:function(){var e=Date.parse("today");e.setMonth(0);e.setDate(1);return e},dateEnd:"today"},{text:"The previous Month",dateStart:function(){return Date.parse("1 month ago").moveToFirstDayOfMonth()},dateEnd:function(){return Date.parse("1 month ago").moveToLastDayOfMonth()}}],presets:{specificDate:"Specific Date",allDatesBefore:"All Dates Before",allDatesAfter:"All Dates After",dateRange:"Date Range"},rangeStartTitle:"Start date",rangeEndTitle:"End date",nextLinkText:"Next",prevLinkText:"Prev",target:n,doneButtonText:"Done",earliestDate:Date.parse("-15years"),latestDate:Date.parse("+15years"),constrainDates:false,rangeSplitter:"-",dateFormat:"m/d/yy",closeOnSelect:true,arrows:false,appendTo:"body",onClose:function(){},onOpen:function(){},onChange:function(){},targetFormElement:null,datepickerOptions:null},t);var i=e(r.targetFormElement);var s={onSelect:function(t,s){var o=l.find(".range-start");var u=l.find(".range-end");if(l.find(".ui-daterangepicker-specificDate").is(".ui-state-active")){u.datepicker("setDate",o.datepicker("getDate"))}e(this).trigger("constrainOtherPicker");var a=h(o.datepicker("getDate"));var f=h(u.datepicker("getDate"));if(n.length==2){n.eq(0).val(a);n.eq(1).val(f)}else{var c=a!=f?a+" "+r.rangeSplitter+" "+f:a;n.val(c);if(i.length){i.val(c)}}if(r.closeOnSelect){if(!l.find("li.ui-state-active").is(".ui-daterangepicker-dateRange")&&!l.is(":animated")){d()}e(this).trigger("constrainOtherPicker");r.onChange([a,f])}},defaultDate:+0};n.bind("change",r.onChange);r.datepickerOptions=t?e.extend(s,t.datepickerOptions):s;var o,u=Date.parse("today");var a,f;if(n.size()==2){a=Date.parse(n.eq(0).val());f=Date.parse(n.eq(1).val());if(a==null){a=f}if(f==null){f=a}}else{if(i.length){a=Date.parse(i.val().split(r.rangeSplitter)[0]);f=Date.parse(i.val().split(r.rangeSplitter)[1])}else{a=Date.parse(n.val().split(r.rangeSplitter)[0]);f=Date.parse(n.val().split(r.rangeSplitter)[1])}if(f==null){f=a}}if(a!=null){o=a}if(f!=null){u=f}var l=e('<div class="ui-daterangepicker ui-widget ui-helper-clearfix ui-widget-content ui-corner-all"></div>');var c=function(){var t=e('<ul class="ui-widget-content"></ul>').appendTo(l);e.each(r.presetRanges,function(){e('<li class="ui-daterangepicker-'+this.text.replace(/ /g,"")+' ui-corner-all"><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).appendTo(t)});var n=0;e.each(r.presets,function(r,i){e('<li class="ui-daterangepicker-'+r+" preset_"+n+' ui-helper-clearfix ui-corner-all"><span class="ui-icon ui-icon-triangle-1-e"></span><a href="#">'+i+"</a></li>").appendTo(t);n++});t.find("li").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).click(function(){l.find(".ui-state-active").removeClass("ui-state-active");e(this).addClass("ui-state-active");g(e(this),l,y,b);return false});return t}();e.fn.restoreDateFromData=function(){if(e(this).data("saveDate")){e(this).datepicker("setDate",e(this).data("saveDate")).removeData("saveDate")}return this};e.fn.saveDateToData=function(){if(!e(this).data("saveDate")){e(this).data("saveDate",e(this).datepicker("getDate"))}return this};var y=e('<div class="ranges ui-widget-header ui-corner-all ui-helper-clearfix"><div class="range-start"><span class="title-start">Start Date</span></div><div class="range-end"><span class="title-end">End Date</span></div></div>').appendTo(l);y.find(".range-start, .range-end").datepicker(r.datepickerOptions);y.find(".range-start").datepicker("setDate",o);y.find(".range-end").datepicker("setDate",u);y.find(".range-start, .range-end").bind("constrainOtherPicker",function(){if(r.constrainDates){if(e(this).is(".range-start")){l.find(".range-end").datepicker("option","minDate",e(this).datepicker("getDate"))}else{l.find(".range-start").datepicker("option","maxDate",e(this).datepicker("getDate"))}}}).trigger("constrainOtherPicker");var b=e('<button class="btnDone ui-state-default ui-corner-all">'+r.doneButtonText+"</button>").click(function(){l.find(".ui-datepicker-current-day").trigger("click");d()}).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).appendTo(y);e(this).click(function(){v();return false});y.hide().find(".range-start, .range-end, .btnDone").hide();l.data("state","closed");y.find(".ui-datepicker").css("display","block");e(r.appendTo).append(l);l.wrap('<div class="ui-daterangepickercontain"></div>');if(r.arrows&&n.size()==1){var w=e('<a href="#" class="ui-daterangepicker-prev ui-corner-all" title="'+r.prevLinkText+'"><span class="ui-icon ui-icon-circle-triangle-w">'+r.prevLinkText+"</span></a>");var E=e('<a href="#" class="ui-daterangepicker-next ui-corner-all" title="'+r.nextLinkText+'"><span class="ui-icon ui-icon-circle-triangle-e">'+r.nextLinkText+"</span></a>");e(this).addClass("ui-rangepicker-input ui-widget-content").wrap('<div class="ui-daterangepicker-arrows ui-widget ui-widget-header ui-helper-clearfix ui-corner-all"></div>').before(w).before(E).parent().find("a").click(function(){var t=y.find(".range-start").datepicker("getDate");var n=y.find(".range-end").datepicker("getDate");var r=Math.abs((new TimeSpan(t-n)).getTotalMilliseconds())+864e5;if(e(this).is(".ui-daterangepicker-prev")){r=-r}y.find(".range-start, .range-end ").each(function(){var t=e(this).datepicker("getDate");if(t==null){return false}e(this).datepicker("setDate",t.add({milliseconds:r})).find(".ui-datepicker-current-day").trigger("click")});return false}).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});var S=n.parent()}e(document).click(function(){if(l.is(":visible")){d()}});l.click(function(){return false}).hide();return this}})(jQuery);